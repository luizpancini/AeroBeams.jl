using Plots, Polynomials, Interpolations, DelimitedFiles

# Compressibility factor as a function of airspeed
function β_of(U)
    return sqrt(1-(U/343)^2)
end

# Span points of data collection
x_data = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0]
nSpanPoints = length(x_data)

# VLM data for lift slope
# Λ0, θ0
y_U0θ0Λ0   = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(0))
y_U10θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(10))
y_U20θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(20))
y_U30θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(30))
y_U40θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(40))
y_U50θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(50))
y_U60θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(60))
y_U70θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(70))
y_U120θ0Λ0  = [5.59, 5.56, 5.46, 5.20, 4.56, 1.40]/(2π/β_of(120))
# Λ0, θ3
y_U0θ3Λ0   = [5.63, 5.59, 5.47, 5.21, 4.57, 1.40]/(2π/β_of(0))
y_U10θ3Λ0  = [5.63, 5.59, 5.47, 5.21, 4.57, 1.40]/(2π/β_of(10))
y_U20θ3Λ0  = [5.68, 5.60, 5.47, 5.20, 4.55, 1.40]/(2π/β_of(20))
y_U30θ3Λ0  = [5.77, 5.62, 5.45, 5.16, 4.50, 1.38]/(2π/β_of(30))
y_U40θ3Λ0  = [5.90, 5.65, 5.40, 5.07, 4.42, 1.36]/(2π/β_of(40))*1.05
y_U50θ3Λ0  = [6.08, 5.65, 5.27, 4.90, 4.25, 1.31]/(2π/β_of(50))*1.10
y_U60θ3Λ0  = [6.29, 5.62, 5.05, 4.59, 3.97, 1.23]/(2π/β_of(60))*1.20
y_U70θ3Λ0  = [6.51, 5.52, 4.73, 4.18, 3.59, 1.13]/(2π/β_of(70))*1.25
y_U120θ3Λ0  = [6.51, 5.52, 4.73, 4.18, 3.59, 1.13]/(2π/β_of(120))*1.5
# Λ0, θ5
y_U0θ5Λ0   = [5.61, 5.57, 5.46, 5.20, 4.55, 1.39]/(2π/β_of(0))
y_U10θ5Λ0  = [5.61, 5.57, 5.46, 5.20, 4.55, 1.39]/(2π/β_of(10))
y_U20θ5Λ0  = [5.67, 5.59, 5.45, 5.18, 4.53, 1.39]/(2π/β_of(20))
y_U30θ5Λ0  = [5.76, 5.60, 5.40, 5.10, 4.45, 1.37]/(2π/β_of(30))
y_U40θ5Λ0  = [5.88, 5.60, 5.28, 4.92, 4.28, 1.32]/(2π/β_of(40))*1.05
y_U50θ5Λ0  = [6.04, 5.54, 5.04, 4.59, 3.97, 1.23]/(2π/β_of(50))*1.10
y_U60θ5Λ0  = [6.19, 5.41, 4.67, 4.13, 3.54, 1.11]/(2π/β_of(60))*1.20
y_U70θ5Λ0  = [6.32, 5.22, 4.24, 3.63, 3.09, 0.98]/(2π/β_of(70))*1.25
y_U120θ5Λ0  = [6.32, 5.22, 4.24, 3.63, 3.09, 0.98]/(2π/β_of(120))*1.5
# Λ0, θ7
y_U0θ7Λ0   = [5.59, 5.54, 5.43, 5.18, 4.53, 1.39]/(2π/β_of(0))
y_U10θ7Λ0  = [5.59, 5.54, 5.43, 5.18, 4.53, 1.39]/(2π/β_of(10))
y_U20θ7Λ0  = [5.64, 5.56, 5.41, 5.14, 4.49, 1.38]/(2π/β_of(20))
y_U30θ7Λ0  = [5.74, 5.57, 5.34, 5.02, 4.38, 1.35]/(2π/β_of(30))
y_U40θ7Λ0  = [5.86, 5.53, 5.14, 4.74, 4.11, 1.27]/(2π/β_of(40))*1.05
y_U50θ7Λ0  = [5.99, 5.41, 4.78, 4.28, 3.68, 1.15]/(2π/β_of(50))*1.10
y_U60θ7Λ0  = [6.11, 5.22, 4.33, 3.74, 3.19, 1.01]/(2π/β_of(60))*1.20
y_U70θ7Λ0  = [6.19, 4.97, 3.85, 3.22, 2.72, 0.87]/(2π/β_of(70))*1.25
y_U120θ7Λ0  = [6.19, 4.97, 3.85, 3.22, 2.72, 0.87]/(2π/β_of(120))*1.5
# Λ10, θ0
y_U0θ0Λ10   = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(0))/cosd(10)^2
y_U10θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(10))/cosd(10)^2
y_U20θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(20))/cosd(10)^2
y_U30θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(30))/cosd(10)^2
y_U40θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(40))/cosd(10)^2
y_U50θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(50))/cosd(10)^2
y_U60θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(60))/cosd(10)^2
y_U70θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(70))/cosd(10)^2
y_U120θ0Λ10  = [5.19, 5.29, 5.29, 5.11, 4.55, 1.41]/(2π/β_of(120))/cosd(10)^2
# Λ10, θ3
y_U0θ3Λ10   = [5.18, 5.31, 5.31, 5.13, 4.56, 1.42]/(2π/β_of(0))/cosd(10)^2
y_U10θ3Λ10  = [5.18, 5.31, 5.31, 5.13, 4.56, 1.42]/(2π/β_of(10))/cosd(10)^2
y_U20θ3Λ10  = [5.11, 5.31, 5.33, 5.15, 4.57, 1.42]/(2π/β_of(20))/cosd(10)^2
y_U30θ3Λ10  = [5.00, 5.31, 5.35, 5.16, 4.57, 1.42]/(2π/β_of(30))/cosd(10)^2
y_U40θ3Λ10  = [4.86, 5.31, 5.38, 5.18, 4.56, 1.41]/(2π/β_of(40))/cosd(10)^2
y_U50θ3Λ10  = [4.71, 5.31, 5.41, 5.19, 4.55, 1.41]/(2π/β_of(50))/cosd(10)^2
y_U60θ3Λ10  = [4.55, 5.30, 5.44, 5.19, 4.53, 1.40]/(2π/β_of(60))/cosd(10)^2
y_U70θ3Λ10  = [4.40, 5.29, 5.47, 5.20, 4.50, 1.38]/(2π/β_of(70))/cosd(10)^2
y_U120θ3Λ10  = [4.40, 5.29, 5.47, 5.20, 4.50, 1.38]/(2π/β_of(120))/cosd(10)^2
# Λ10, θ5
y_U0θ5Λ10   = [5.16, 5.29, 5.29, 5.12, 4.55, 1.41]/(2π/β_of(0))/cosd(10)^2
y_U10θ5Λ10  = [5.16, 5.29, 5.29, 5.12, 4.55, 1.41]/(2π/β_of(10))/cosd(10)^2
y_U20θ5Λ10  = [5.09, 5.30, 5.31, 5.13, 4.55, 1.41]/(2π/β_of(20))/cosd(10)^2
y_U30θ5Λ10  = [4.98, 5.30, 5.32, 5.13, 4.53, 1.41]/(2π/β_of(30))/cosd(10)^2
y_U40θ5Λ10  = [4.85, 5.29, 5.33, 5.11, 4.50, 1.39]/(2π/β_of(40))/cosd(10)^2
y_U50θ5Λ10  = [4.70, 5.27, 5.32, 5.06, 4.43, 1.37]/(2π/β_of(50))/cosd(10)^2
y_U60θ5Λ10  = [4.56, 5.24, 5.29, 5.00, 4.35, 1.34]/(2π/β_of(60))/cosd(10)^2
y_U70θ5Λ10  = [4.41, 5.20, 5.26, 4.92, 4.25, 1.31]/(2π/β_of(70))/cosd(10)^2
y_U120θ5Λ10  = [4.41, 5.20, 5.26, 4.92, 4.25, 1.31]/(2π/β_of(120))/cosd(10)^2
# Λ10, θ7
y_U0θ7Λ10   = [5.14, 5.27, 5.27, 5.09, 4.52, 1.40]/(2π/β_of(0))/cosd(10)^2
y_U10θ7Λ10  = [5.14, 5.27, 5.27, 5.09, 4.52, 1.40]/(2π/β_of(10))/cosd(10)^2
y_U20θ7Λ10  = [5.07, 5.27, 5.28, 5.10, 4.52, 1.40]/(2π/β_of(20))/cosd(10)^2
y_U30θ7Λ10  = [4.97, 5.27, 5.28, 5.08, 4.49, 1.39]/(2π/β_of(30))/cosd(10)^2
y_U40θ7Λ10  = [4.84, 5.25, 5.25, 5.01, 4.41, 1.37]/(2π/β_of(40))/cosd(10)^2
y_U50θ7Λ10  = [4.70, 5.21, 5.19, 4.90, 4.28, 1.33]/(2π/β_of(50))/cosd(10)^2
y_U60θ7Λ10  = [4.56, 5.16, 5.10, 4.76, 4.12, 1.28]/(2π/β_of(60))/cosd(10)^2
y_U70θ7Λ10  = [4.43, 5.10, 4.99, 4.60, 3.95, 1.22]/(2π/β_of(70))/cosd(10)^2
y_U120θ7Λ10  = [4.43, 5.10, 4.99, 4.60, 3.95, 1.22]/(2π/β_of(120))/cosd(10)^2
# Λ20, θ0
y_U0θ0Λ20   = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(0))/cosd(20)^2
y_U10θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(10))/cosd(20)^2
y_U20θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(20))/cosd(20)^2
y_U30θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(30))/cosd(20)^2
y_U40θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(40))/cosd(20)^2
y_U50θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(50))/cosd(20)^2
y_U60θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(60))/cosd(20)^2
y_U70θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(70))/cosd(20)^2
y_U120θ0Λ20  = [4.52, 4.73, 4.80, 4.71, 4.26, 1.33]/(2π/β_of(120))/cosd(20)^2
# Λ20, θ3
y_U0θ3Λ20   = [4.50, 4.74, 4.83, 4.73, 4.28, 1.34]/(2π/β_of(0))/cosd(20)^2
y_U10θ3Λ20  = [4.50, 4.74, 4.83, 4.73, 4.28, 1.34]/(2π/β_of(10))/cosd(20)^2
y_U20θ3Λ20  = [4.42, 4.75, 4.85, 4.76, 4.29, 1.35]/(2π/β_of(20))/cosd(20)^2
y_U30θ3Λ20  = [4.29, 4.75, 4.90, 4.80, 4.31, 1.35]/(2π/β_of(30))/cosd(20)^2
y_U40θ3Λ20  = [4.13, 4.75, 4.96, 4.86, 4.34, 1.36]/(2π/β_of(40))/cosd(20)^2
y_U50θ3Λ20  = [3.98, 4.75, 5.03, 4.93, 4.38, 1.36]/(2π/β_of(50))/cosd(20)^2
y_U60θ3Λ20  = [3.83, 4.76, 5.12, 5.01, 4.43, 1.37]/(2π/β_of(60))/cosd(20)^2
y_U70θ3Λ20  = [3.69, 4.76, 5.22, 5.12, 4.49, 1.38]/(2π/β_of(70))/cosd(20)^2
y_U120θ3Λ20  = [3.69, 4.76, 5.22, 5.12, 4.49, 1.38]/(2π/β_of(120))/cosd(20)^2
# Λ20, θ5
y_U0θ5Λ20   = [4.49, 4.73, 4.81, 4.72, 4.26, 1.34]/(2π/β_of(0))/cosd(20)^2
y_U10θ5Λ20  = [4.49, 4.73, 4.81, 4.72, 4.26, 1.34]/(2π/β_of(10))/cosd(20)^2
y_U20θ5Λ20  = [4.40, 4.73, 4.84, 4.74, 4.28, 1.34]/(2π/β_of(20))/cosd(20)^2
y_U30θ5Λ20  = [4.27, 4.73, 4.88, 4.78, 4.29, 1.34]/(2π/β_of(30))/cosd(20)^2
y_U40θ5Λ20  = [4.12, 4.73, 4.93, 4.82, 4.31, 1.35]/(2π/β_of(40))/cosd(20)^2
y_U50θ5Λ20  = [3.97, 4.73, 4.99, 4.88, 4.33, 1.35]/(2π/β_of(50))/cosd(20)^2
y_U60θ5Λ20  = [3.82, 4.73, 5.06, 4.94, 4.36, 1.35]/(2π/β_of(60))/cosd(20)^2
y_U70θ5Λ20  = [3.69, 4.72, 5.14, 5.02, 4.39, 1.35]/(2π/β_of(70))/cosd(20)^2
y_U120θ5Λ20  = [3.69, 4.72, 5.14, 5.02, 4.39, 1.35]/(2π/β_of(120))/cosd(20)^2
# Λ20, θ7
y_U0θ7Λ20   = [4.47, 4.71, 4.79, 4.69, 4.24, 1.33]/(2π/β_of(0))/cosd(20)^2
y_U10θ7Λ20  = [4.47, 4.71, 4.79, 4.69, 4.24, 1.33]/(2π/β_of(10))/cosd(20)^2
y_U20θ7Λ20  = [4.38, 4.71, 4.82, 4.72, 4.25, 1.33]/(2π/β_of(20))/cosd(20)^2
y_U30θ7Λ20  = [4.26, 4.71, 4.85, 4.75, 4.26, 1.34]/(2π/β_of(30))/cosd(20)^2
y_U40θ7Λ20  = [4.11, 4.71, 4.89, 4.77, 4.27, 1.33]/(2π/β_of(40))/cosd(20)^2
y_U50θ7Λ20  = [3.96, 4.70, 4.93, 4.80, 4.26, 1.33]/(2π/β_of(50))/cosd(20)^2
y_U60θ7Λ20  = [3.82, 4.69, 4.98, 4.83, 4.25, 1.32]/(2π/β_of(60))/cosd(20)^2
y_U70θ7Λ20  = [3.69, 4.68, 5.03, 4.87, 4.25, 1.31]/(2π/β_of(70))/cosd(20)^2
y_U120θ7Λ20  = [3.69, 4.68, 5.03, 4.87, 4.25, 1.31]/(2π/β_of(120))/cosd(20)^2
# Λ30, θ0
y_U0θ0Λ30   = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(0))/cosd(30)^2
y_U10θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(10))/cosd(30)^2
y_U20θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(20))/cosd(30)^2
y_U30θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(30))/cosd(30)^2
y_U40θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(40))/cosd(30)^2
y_U50θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(50))/cosd(30)^2
y_U60θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(60))/cosd(30)^2
y_U70θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(70))/cosd(30)^2
y_U120θ0Λ30  = [3.69, 3.94, 4.07, 4.04, 3.72, 1.18]/(2π/β_of(120))/cosd(30)^2
# Λ30, θ3
y_U0θ3Λ30   = [3.68, 3.96, 4.09, 4.06, 3.73, 1.19]/(2π/β_of(0))/cosd(30)^2
y_U10θ3Λ30  = [3.68, 3.96, 4.09, 4.06, 3.73, 1.19]/(2π/β_of(10))/cosd(30)^2
y_U20θ3Λ30  = [3.62, 3.96, 4.11, 4.08, 3.75, 1.19]/(2π/β_of(20))/cosd(30)^2
y_U30θ3Λ30  = [3.54, 3.97, 4.14, 4.12, 3.77, 1.00]/(2π/β_of(30))/cosd(30)^2
y_U40θ3Λ30  = [3.44, 3.98, 4.19, 4.16, 3.79, 1.20]/(2π/β_of(40))/cosd(30)^2
y_U50θ3Λ30  = [3.33, 3.98, 4.26, 4.22, 3.83, 1.00]/(2π/β_of(50))/cosd(30)^2
y_U60θ3Λ30  = [3.22, 4.00, 4.33, 4.30, 3.88, 1.00]/(2π/β_of(60))/cosd(30)^2
y_U70θ3Λ30  = [3.12, 4.01, 4.42, 4.39, 3.93, 1.23]/(2π/β_of(70))/cosd(30)^2
y_U120θ3Λ30  = [3.12, 4.01, 4.42, 4.39, 3.93, 1.23]/(2π/β_of(120))/cosd(30)^2
# Λ30, θ5
y_U0θ5Λ30   = [3.67, 3.94, 4.07, 4.05, 3.72, 1.18]/(2π/β_of(0))/cosd(30)^2
y_U10θ5Λ30  = [3.67, 3.94, 4.07, 4.05, 3.72, 1.18]/(2π/β_of(10))/cosd(30)^2
y_U20θ5Λ30  = [3.61, 3.95, 4.10, 4.07, 3.74, 1.19]/(2π/β_of(20))/cosd(30)^2
y_U30θ5Λ30  = [3.53, 3.96, 4.13, 4.10, 3.75, 1.19]/(2π/β_of(30))/cosd(30)^2
y_U40θ5Λ30  = [3.42, 3.96, 4.18, 4.15, 3.78, 1.20]/(2π/β_of(40))/cosd(30)^2
y_U50θ5Λ30  = [3.32, 3.97, 4.24, 4.20, 3.81, 1.20]/(2π/β_of(50))/cosd(30)^2
y_U60θ5Λ30  = [3.21, 3.98, 4.31, 4.27, 3.85, 1.21]/(2π/β_of(60))/cosd(30)^2
y_U70θ5Λ30  = [3.11, 3.99, 4.39, 4.36, 3.90, 1.22]/(2π/β_of(70))/cosd(30)^2
y_U120θ5Λ30  = [3.11, 3.99, 4.39, 4.36, 3.90, 1.22]/(2π/β_of(120))/cosd(30)^2
# Λ30, θ7
y_U0θ7Λ30   = [3.65, 3.93, 4.05, 4.03, 3.70, 1.18]/(2π/β_of(0))/cosd(30)^2
y_U10θ7Λ30  = [3.65, 3.93, 4.05, 4.03, 3.70, 1.18]/(2π/β_of(10))/cosd(30)^2
y_U20θ7Λ30  = [3.59, 3.93, 4.08, 4.05, 3.72, 1.18]/(2π/β_of(20))/cosd(30)^2
y_U30θ7Λ30  = [3.51, 3.94, 4.11, 4.08, 3.73, 1.18]/(2π/β_of(30))/cosd(30)^2
y_U40θ7Λ30  = [3.41, 3.95, 4.16, 4.12, 3.76, 1.19]/(2π/β_of(40))/cosd(30)^2
y_U50θ7Λ30  = [3.30, 3.95, 4.21, 4.17, 3.78, 1.19]/(2π/β_of(50))/cosd(30)^2
y_U60θ7Λ30  = [3.20, 3.96, 4.27, 4.23, 3.81, 1.19]/(2π/β_of(60))/cosd(30)^2
y_U70θ7Λ30  = [3.10, 3.96, 4.34, 4.30, 3.84, 1.20]/(2π/β_of(70))/cosd(30)^2
y_U120θ7Λ30  = [3.10, 3.96, 4.34, 4.30, 3.84, 1.20]/(2π/β_of(120))/cosd(30)^2

y = [[# Λ0
        # θ0
        [y_U0θ0Λ0, y_U10θ0Λ0, y_U20θ0Λ0, y_U30θ0Λ0, y_U40θ0Λ0, y_U50θ0Λ0, y_U60θ0Λ0, y_U70θ0Λ0, y_U120θ0Λ0],
        # θ3
        [y_U0θ3Λ0, y_U10θ3Λ0, y_U20θ3Λ0, y_U30θ3Λ0, y_U40θ3Λ0, y_U50θ3Λ0, y_U60θ3Λ0, y_U70θ3Λ0, y_U120θ3Λ0],
        # θ5
        [y_U0θ5Λ0, y_U10θ5Λ0, y_U20θ5Λ0, y_U30θ5Λ0, y_U40θ5Λ0, y_U50θ5Λ0, y_U60θ5Λ0, y_U70θ5Λ0, y_U120θ5Λ0],
        # θ7
        [y_U0θ7Λ0, y_U10θ7Λ0, y_U20θ7Λ0, y_U30θ7Λ0, y_U40θ7Λ0, y_U50θ7Λ0, y_U60θ7Λ0, y_U70θ7Λ0, y_U120θ7Λ0]],
    [# Λ10
        # θ0
        [y_U0θ0Λ10, y_U10θ0Λ10, y_U20θ0Λ10, y_U30θ0Λ10, y_U40θ0Λ10, y_U50θ0Λ10, y_U60θ0Λ10, y_U70θ0Λ10, y_U120θ0Λ10],
        # θ3
        [y_U0θ3Λ10, y_U10θ3Λ10, y_U20θ3Λ10, y_U30θ3Λ10, y_U40θ3Λ10, y_U50θ3Λ10, y_U60θ3Λ10, y_U70θ3Λ10, y_U120θ3Λ10],
        # θ5
        [y_U0θ5Λ10, y_U10θ5Λ10, y_U20θ5Λ10, y_U30θ5Λ10, y_U40θ5Λ10, y_U50θ5Λ10, y_U60θ5Λ10, y_U70θ5Λ10, y_U120θ5Λ10],
        # θ7
        [y_U0θ7Λ10, y_U10θ7Λ10, y_U20θ7Λ10, y_U30θ7Λ10, y_U40θ7Λ10, y_U50θ7Λ10, y_U60θ7Λ10, y_U70θ7Λ10, y_U120θ7Λ10]],
     [# Λ20
        # θ0
        [y_U0θ0Λ20, y_U10θ0Λ20, y_U20θ0Λ20, y_U30θ0Λ20, y_U40θ0Λ20, y_U50θ0Λ20, y_U60θ0Λ20, y_U70θ0Λ20, y_U120θ0Λ20],
        # θ3
        [y_U0θ3Λ20, y_U10θ3Λ20, y_U20θ3Λ20, y_U30θ3Λ20, y_U40θ3Λ20, y_U50θ3Λ20, y_U60θ3Λ20, y_U70θ3Λ20, y_U120θ3Λ20],
        # θ5
        [y_U0θ5Λ20, y_U10θ5Λ20, y_U20θ5Λ20, y_U30θ5Λ20, y_U40θ5Λ20, y_U50θ5Λ20, y_U60θ5Λ20, y_U70θ5Λ20, y_U120θ5Λ20],
        # θ7
        [y_U0θ7Λ20, y_U10θ7Λ20, y_U20θ7Λ20, y_U30θ7Λ20, y_U40θ7Λ20, y_U50θ7Λ20, y_U60θ7Λ20, y_U70θ7Λ20, y_U120θ7Λ20]],    
     [# Λ30  
        # θ0
        [y_U0θ0Λ30, y_U10θ0Λ30, y_U20θ0Λ30, y_U30θ0Λ30, y_U40θ0Λ30, y_U50θ0Λ30, y_U60θ0Λ30, y_U70θ0Λ30, y_U120θ0Λ30],
        # θ3
        [y_U0θ3Λ30, y_U10θ3Λ30, y_U20θ3Λ30, y_U30θ3Λ30, y_U40θ3Λ30, y_U50θ3Λ30, y_U60θ3Λ30, y_U70θ3Λ30, y_U120θ3Λ30],
        # θ5
        [y_U0θ5Λ30, y_U10θ5Λ30, y_U20θ5Λ30, y_U30θ5Λ30, y_U40θ5Λ30, y_U50θ5Λ30, y_U60θ5Λ30, y_U70θ5Λ30, y_U120θ5Λ30],
        # θ7
        [y_U0θ7Λ30, y_U10θ7Λ30, y_U20θ7Λ30, y_U30θ7Λ30, y_U40θ7Λ30, y_U50θ7Λ30, y_U60θ7Λ30, y_U70θ7Λ30, y_U120θ7Λ30]]]

# Define ranges
ΛRange = [0,10,20,30]*π/180
θRange = [0,3,5,7]*π/180
URange = vcat(0:10:70,120)

# Order of polynomial
order = 8

# Define coefficient storage
polyCoeffs = zeros(order+1, length(ΛRange), length(θRange), length(URange))

# Sweep conditions
for (i, Λ) in enumerate(ΛRange)
    for (j, θ) in enumerate(θRange)
        for (k, U) in enumerate(URange)
            # Lift slope at current condition
            y_data = y[i][j][k]
            # Fit polynomial
            p = fit(x_data, y_data, order)
            # Store coefficients
            for n=1:order+1
                polyCoeffs[n, i, j, k] = p.coeffs[n]
            end
        end
    end
end

# Save the coefficients
mkpath(pkgdir(AeroBeams)*"/test/referenceData/sweptPazy")
for j=1:length(θRange)
    for k=1:length(URange)
        writedlm(pkgdir(AeroBeams)*"/test/referenceData/sweptPazy/polyCoeffsDef_"*string(j)*"_"*string(k)*".txt", polyCoeffs[:,:,j,k])
    end
end

# Construct polynomial at query point
function interpolate_polynomial(polyCoeffs, ΛRange, θRange, URange, Λq, θq, Uq)
    order = size(polyCoeffs,1)-1
    q = zeros(order+1)
    for i=1:order+1
        itp = Interpolations.interpolate((ΛRange, θRange, URange), polyCoeffs[i,:,:,:], Gridded(Linear()))
        q[i] = itp(Λq, θq, Uq)
    end
    return Polynomial(q)
end

# Example query and corresponding lift slope
Λq, θq, Uq = 0*π/180, 7*π/180, 70
y_data = y_U70θ7Λ0

# Interpolation polynomial
p_q = interpolate_polynomial(polyCoeffs, ΛRange, θRange, URange, Λq, θq, Uq)

# Domain
x = 0:0.01:1

# Plot
plt = plot(xlims=[0,1], ylims=[0,1], xlabel="Normalized span", ylabel="Normalized lift slope, \$c_{n_\\alpha}/(2\\pi/\\beta)\$")
scatter!(x_data, y_data, c=:black, label="Data points")
plot!(x,p_q.(x), label="Polynomial fit")
display(plt)