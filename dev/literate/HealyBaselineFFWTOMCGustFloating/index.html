<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Gust response of a wing with flared folding wingtip (FFWT) · AeroBeams.jl</title><meta name="title" content="Gust response of a wing with flared folding wingtip (FFWT) · AeroBeams.jl"/><meta property="og:title" content="Gust response of a wing with flared folding wingtip (FFWT) · AeroBeams.jl"/><meta property="twitter:title" content="Gust response of a wing with flared folding wingtip (FFWT) · AeroBeams.jl"/><meta name="description" content="Documentation for AeroBeams.jl."/><meta property="og:description" content="Documentation for AeroBeams.jl."/><meta property="twitter:description" content="Documentation for AeroBeams.jl."/><meta property="og:url" content="https://luizpancini.github.io/AeroBeams.jl/literate/HealyBaselineFFWTOMCGustFloating/"/><meta property="twitter:url" content="https://luizpancini.github.io/AeroBeams.jl/literate/HealyBaselineFFWTOMCGustFloating/"/><link rel="canonical" href="https://luizpancini.github.io/AeroBeams.jl/literate/HealyBaselineFFWTOMCGustFloating/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AeroBeams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../conventionalHALEmodel/">Creating a HALE aircraft model</a></li><li><a class="tocitem" href="../OMCgustTests/">Gust response of an airfoil section</a></li><li><a class="tocitem" href="../typicalSectionFlutterAndDivergence/">Flutter and divergence of a typical aeroelastic section</a></li><li><a class="tocitem" href="../archUnderFollowerPressure/">Static structural analysis of an arch under follower pressure</a></li><li><a class="tocitem" href="../compositeCantileverMD/">Static structural analysis of composite beams</a></li><li><a class="tocitem" href="../PazyWingTorsionTest/">Static structural analysis of the Pazy wing</a></li><li><a class="tocitem" href="../PazyWingPitchRange/">Steady aeroelastic analysis of the Pazy Wing</a></li><li><a class="tocitem" href="../HealyBaselineFFWTfreeFlutterAoARangeURange/">Flutter analysis of a wing with flared folding wingtip (FFWT)</a></li><li><a class="tocitem" href="../HealyFFWTsteadyTwistRangeAoARangeSideslipRangeCoast/">Steady aeroelastic analysis of a wing with flared folding wingtip (FFWT)</a></li><li><a class="tocitem" href="../PazyWingFlutterPitchRange/">Flutter analysis of the Pazy wing</a></li><li><a class="tocitem" href="../sweptTipRotor/">Modal analysis of a rotating beam</a></li><li><a class="tocitem" href="../twoStoryFrame/">Modal analysis of a two-story frame</a></li><li><a class="tocitem" href="../initialDispAndVelBeam/">Motion of a simply supported beam under initial conditions</a></li><li><a class="tocitem" href="../flyingScissors/">Dynamic analysis of an articulated beam</a></li><li class="is-active"><a class="tocitem" href>Gust response of a wing with flared folding wingtip (FFWT)</a></li><li><a class="tocitem" href="../heliosTrim/">Trimming a flying-wing HALE</a></li><li><a class="tocitem" href="../BWBflutter/">Flutter of a Blended-Wing-Body</a></li><li><a class="tocitem" href="../conventionalHALECheckedPitchManeuver/">Pitch maneuver of a HALE aircraft</a></li><li><a class="tocitem" href="../conventionalHALECheckedRollManeuver/">Coordinated turn maneuver of a HALE aircraft</a></li></ul></li><li><a class="tocitem" href="../../publicAPI/">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Gust response of a wing with flared folding wingtip (FFWT)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Gust response of a wing with flared folding wingtip (FFWT)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/luizpancini/AeroBeams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/luizpancini/AeroBeams.jl/blob/main/test/examples/HealyBaselineFFWTOMCGustFloating.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Gust-response-of-a-wing-with-flared-folding-wingtip-(FFWT)"><a class="docs-heading-anchor" href="#Gust-response-of-a-wing-with-flared-folding-wingtip-(FFWT)">Gust response of a wing with flared folding wingtip (FFWT)</a><a id="Gust-response-of-a-wing-with-flared-folding-wingtip-(FFWT)-1"></a><a class="docs-heading-anchor-permalink" href="#Gust-response-of-a-wing-with-flared-folding-wingtip-(FFWT)" title="Permalink"></a></h1><p>This example illustrates how to set up a dynamic gust response analysis for a wing featuring a flared folding wingtip (FFWT). The influence of a one-minus-cosine gust frequency on the behavior of this wing model was studied numerically by <a href="https://research-information.bris.ac.uk/ws/portalfiles/portal/388426634/Final_Copy_2024_01_23_Healy_F_PhD_Redacted.pdf">Healy&#39;s PhD Thesis</a>.</p><p><img src="../../assets/HealyBaselineFFWT.png" alt/></p><p><em>Top view of baseline wing model featuring a FFWT</em> by <a href="https://doi.org/10.2514/6.2023-0376">Healy et al.</a></p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The code for this example is available <a href="https://github.com/luizpancini/AeroBeams.jl/blob/main/test/examples/HealyBaselineFFWTOMCGustFloating.jl">here</a>.</p></div></div><h3 id="Problem-setup"><a class="docs-heading-anchor" href="#Problem-setup">Problem setup</a><a id="Problem-setup-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-setup" title="Permalink"></a></h3><p>Let&#39;s begin by setting the variables of our problem. In this example we will analyze the response of the coasting (fold) angle and wing root bending moment (WRBM) to a series of one-minus-cosine gusts with different frequencies (meaning different durations). The hinge is assumed as a universal joint (allowing movement about the three axes), but the restriction of the in-plane bending DOF is modeled through a stiff spring with value <code>kIPBendingHinge</code>.</p><pre><code class="language-julia hljs">using AeroBeams, DelimitedFiles

# Gust frequency range [Hz]
ωRange = [1,3,10]

# Gust maximum vertical velocity [m/s]
Ug = 0.5

# Hinge configuration
hingeConfiguration = &quot;free&quot;

# Fold angle [rad]
foldAngle = nothing

# Flare angle [rad]
Λ = 15*π/180

# Root pitch angle [rad]
θ = 7.5*π/180

# Airspeed [m/s]
U = 18

# Stiffness of the spring around the hinge for in-plane bending
kIPBendingHinge = 1e4

# Gravity
g = 9.80665

# Discretization
nElementsInner = 16
nElementsFFWT = 4
nElem = nElementsInner + nElementsFFWT

# Tip loss options
withTipCorrection = true
tipLossDecayFactor = 12

# Solution method for hinge constraint
solutionMethod = &quot;addedResidual&quot;

# Time variables
Δt = 1e-3
tf = 2

# System solver
σ0 = 1
maxIter = 200
relTol = 1e-7
NR = create_NewtonRaphson(displayStatus=false,initialLoadFactor=σ0,maximumIterations=maxIter,relativeTolerance=relTol)

# Initialize outputs
t = Array{Vector{Float64}}(undef,length(ωRange))
M2root = Array{Vector{Float64}}(undef,length(ωRange))
ϕ = Array{Vector{Float64}}(undef,length(ωRange))
problem = Array{DynamicProblem}(undef,length(ωRange))</code></pre><h3 id="Solving-the-problem"><a class="docs-heading-anchor" href="#Solving-the-problem">Solving the problem</a><a id="Solving-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-problem" title="Permalink"></a></h3><p>In the following loop, we create new gust and model instances for each gust frequency, create and solve the dynamic problem, and then extract the coasting angle of the FFWT (<code>ϕ</code>) and the out-of-plane bending moment at the root (<code>M2root</code>). The model creation process is streamlined with the function <a href="../../publicAPI/#AeroBeams.create_HealyBaselineFFWT"><code>create_HealyBaselineFFWT</code></a>, taking the appropriate inputs. For nonzero pitch angles, the algorithm fails to converge at low airspeed values.</p><pre><code class="language-julia hljs"># Loop gust frequency range
for (i,ω) in enumerate(ωRange)
    # Display progress
    # Gust
    gust = create_OneMinusCosineGust(initialTime=0,duration=1/ω,verticalVelocity=Ug)
    # Model
    model = create_HealyBaselineFFWT(solutionMethod=solutionMethod,hingeConfiguration=hingeConfiguration,foldAngle=foldAngle,flareAngle=Λ,kIPBendingHinge=kIPBendingHinge,airspeed=U,pitchAngle=θ,withTipCorrection=withTipCorrection,tipLossDecayFactor=tipLossDecayFactor,nElementsInner=nElementsInner,nElementsFFWT=nElementsFFWT,g=g,gust=gust)
    # Solve steady problem for initial conditions
    steadyProblem = create_SteadyProblem(model=model,systemSolver=NR)
    solve!(steadyProblem)
    # Create and solve dynamic problem
    problem[i] = create_DynamicProblem(model=model,finalTime=tf,Δt=Δt,systemSolver=NR,skipInitialStatesUpdate=true,x0=steadyProblem.x)
            solve!(problem[i])
    # Unpack numerical solution
    t[i] = problem[i].savedTimeVector
    M2root[i] = [problem[i].nodalStatesOverTime[j][1].M_n1[2] for j in 1:length(t[i])]
    ϕ[i] = [problem[i].hingeAxisConstraintsDataOverTime[j][1].ϕ*180/π for j in 1:length(t[i])]
end</code></pre><h3 id="Post-processing"><a class="docs-heading-anchor" href="#Post-processing">Post-processing</a><a id="Post-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Post-processing" title="Permalink"></a></h3><p>First, we choose which of Healy&#39;s reference model we will use. Then, we load the corresponding data.</p><pre><code class="language-julia hljs"># Select reference data (choose between &quot;baseline&quot; or &quot;ASMVLM&quot;)
refModel = &quot;baseline&quot;

# Load reference data
if refModel == &quot;baseline&quot;
    ΔWRBM_Healy_1Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_baseline_1Hz.txt&quot;)
    ΔWRBM_Healy_3Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_baseline_3Hz.txt&quot;)
    ΔWRBM_Healy_10Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_baseline_10Hz.txt&quot;)
    fold_Healy_1Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_baseline_1Hz.txt&quot;)
    fold_Healy_3Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_baseline_3Hz.txt&quot;)
    fold_Healy_10Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_baseline_10Hz.txt&quot;)
elseif refModel == &quot;ASMVLM&quot;
    ΔWRBM_Healy_1Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_ASMVLM_1Hz.txt&quot;)
    ΔWRBM_Healy_3Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_ASMVLM_3Hz.txt&quot;)
    ΔWRBM_Healy_10Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/DWRBM_ASMVLM_10Hz.txt&quot;)
    fold_Healy_1Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_ASMVLM_1Hz.txt&quot;)
    fold_Healy_3Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_ASMVLM_3Hz.txt&quot;)
    fold_Healy_10Hz = readdlm(pkgdir(AeroBeams)*&quot;/test/referenceData/HealyBaselineFFWTOMCGustFloating/fold_ASMVLM_10Hz.txt&quot;)
else
    error(&quot;Select refModel as &#39;baseline&#39; or &#39;ASMVLM&#39;&quot;)
end</code></pre><p>We can now plot the increments in the fold angle and root bending moment of the wing for each of the gusts. The following reference results were taken from Fig. 3.34 of <a href="https://research-information.bris.ac.uk/ws/portalfiles/portal/388426634/Final_Copy_2024_01_23_Healy_F_PhD_Redacted.pdf">Healy&#39;s PhD Thesis</a>. The evolution of the fold angle and root bending moment is closely matched for the first few peaks, but then the correlation with the reference deteriorates somewhat: AeroBeams predicts oscillations with less damping and with a different frequency content. Nevertheless, the maximum loads, which are arguably the most important outputs, are captured with reasonable accuracy.</p><pre><code class="language-julia hljs">using Plots, ColorSchemes
gr()
colors = cgrad(:rainbow, length(ωRange), categorical=true)
lw = 2

# Fold angle increment
plt_ϕ = plot(xlabel=&quot;Time [s]&quot;, ylabel=&quot;Fold angle increment [deg]&quot;, ylims=[-20,20], legendfontsize=10, legend=:topright)
plot!([NaN],[NaN], c=:black, lw=lw, ls=:solid, label=&quot;AeroBeams&quot;)
plot!([NaN],[NaN], c=:black, lw=lw, ls=:dashdot, label=&quot;Healy (2023)&quot;)
for (i,ω) in enumerate(ωRange)
    plot!(t[i], -(ϕ[i] .- ϕ[i][1]), c=colors[i], lw=lw, ls=:solid, label=&quot;\$\\omega_g = $ω\$ Hz&quot;)
    if ω==1
        plot!(fold_Healy_1Hz[1,:],fold_Healy_1Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    elseif ω==3
        plot!(fold_Healy_3Hz[1,:],fold_Healy_3Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    else ω==10
        plot!(fold_Healy_10Hz[1,:],fold_Healy_10Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    end
end
savefig(&quot;HealyBaselineFFWTOMCGustFloating_phi.svg&quot;)

# Root OOP bending moment increment
plt_ΔWRBM = plot(xlabel=&quot;Time [s]&quot;, ylabel=&quot;ΔWRBM [N.m]&quot;)
for (i,ω) in enumerate(ωRange)
    plot!(t[i], -(M2root[i] .- M2root[i][1]), c=colors[i], lw=lw, ls=:solid, label=false)
    if ω==1
        plot!(ΔWRBM_Healy_1Hz[1,:],ΔWRBM_Healy_1Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    elseif ω==3
        plot!(ΔWRBM_Healy_3Hz[1,:],ΔWRBM_Healy_3Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    elseif ω==10
        plot!(ΔWRBM_Healy_10Hz[1,:],ΔWRBM_Healy_10Hz[2,:], c=colors[i], lw=lw, ls=:dashdot, label=false)
    end
end
savefig(&quot;HealyBaselineFFWTOMCGustFloating_DWRBM.svg&quot;)</code></pre><p><img src="../HealyBaselineFFWTOMCGustFloating_phi.svg" alt/> <img src="../HealyBaselineFFWTOMCGustFloating_DWRBM.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../flyingScissors/">« Dynamic analysis of an articulated beam</a><a class="docs-footer-nextpage" href="../heliosTrim/">Trimming a flying-wing HALE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Wednesday 19 February 2025 17:56">Wednesday 19 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
