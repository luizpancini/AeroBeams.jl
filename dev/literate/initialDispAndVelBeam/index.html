<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Motion of a simply supported beam under initial conditions · AeroBeams.jl</title><meta name="title" content="Motion of a simply supported beam under initial conditions · AeroBeams.jl"/><meta property="og:title" content="Motion of a simply supported beam under initial conditions · AeroBeams.jl"/><meta property="twitter:title" content="Motion of a simply supported beam under initial conditions · AeroBeams.jl"/><meta name="description" content="Documentation for AeroBeams.jl."/><meta property="og:description" content="Documentation for AeroBeams.jl."/><meta property="twitter:description" content="Documentation for AeroBeams.jl."/><meta property="og:url" content="https://luizpancini.github.io/AeroBeams.jl/literate/initialDispAndVelBeam/"/><meta property="twitter:url" content="https://luizpancini.github.io/AeroBeams.jl/literate/initialDispAndVelBeam/"/><link rel="canonical" href="https://luizpancini.github.io/AeroBeams.jl/literate/initialDispAndVelBeam/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AeroBeams.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../theory/">Theory</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../conventionalHALEmodel/">Creating a HALE aircraft model</a></li><li><a class="tocitem" href="../OMCgustTests/">Gust response of an airfoil section</a></li><li><a class="tocitem" href="../typicalSectionFlutterAndDivergence/">Flutter and divergence of a typical aeroelastic section</a></li><li><a class="tocitem" href="../archUnderFollowerPressure/">Static structural analysis of an arch under follower pressure</a></li><li><a class="tocitem" href="../compositeCantileverMD/">Static structural analysis of composite beams</a></li><li><a class="tocitem" href="../PazyWingTorsionTest/">Static structural analysis of the Pazy wing</a></li><li><a class="tocitem" href="../PazyWingPitchRange/">Steady aeroelastic analysis of the Pazy Wing</a></li><li><a class="tocitem" href="../HealyBaselineFFWTfreeFlutterAoARangeURange/">Flutter analysis of a wing with flared folding wingtip (FFWT)</a></li><li><a class="tocitem" href="../HealyFFWTsteadyTwistRangeAoARangeSideslipRangeCoast/">Steady aeroelastic analysis of a wing with flared folding wingtip (FFWT)</a></li><li><a class="tocitem" href="../PazyWingFlutterPitchRange/">Flutter analysis of the Pazy wing</a></li><li><a class="tocitem" href="../sweptTipRotor/">Modal analysis of a rotating beam</a></li><li><a class="tocitem" href="../twoStoryFrame/">Modal analysis of a two-story frame</a></li><li class="is-active"><a class="tocitem" href>Motion of a simply supported beam under initial conditions</a></li><li><a class="tocitem" href="../flyingScissors/">Dynamic analysis of an articulated beam</a></li><li><a class="tocitem" href="../heliosTrim/">Trimming a flying-wing HALE</a></li><li><a class="tocitem" href="../BWBflutter/">Flutter of a Blended-Wing-Body</a></li><li><a class="tocitem" href="../conventionalHALECheckedPitchManeuver/">Pitch maneuver of a HALE aircraft</a></li></ul></li><li><a class="tocitem" href="../../publicAPI/">Public API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Motion of a simply supported beam under initial conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Motion of a simply supported beam under initial conditions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/luizpancini/AeroBeams.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/luizpancini/AeroBeams.jl/blob/main/test/examples/initialDispAndVelBeam.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Motion-of-a-simply-supported-beam-under-initial-conditions"><a class="docs-heading-anchor" href="#Motion-of-a-simply-supported-beam-under-initial-conditions">Motion of a simply supported beam under initial conditions</a><a id="Motion-of-a-simply-supported-beam-under-initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Motion-of-a-simply-supported-beam-under-initial-conditions" title="Permalink"></a></h1><p>This example illustrates how to set up a dynamic analysis with initial conditions. To do that, we take a simply supported beam under a specified combination of sinusoidal initial displacement and velocity.</p><div class="admonition is-success" id="Tip-f2aa2814c9b40301"><header class="admonition-header">Tip<a class="admonition-anchor" href="#Tip-f2aa2814c9b40301" title="Permalink"></a></header><div class="admonition-body"><p>The code for this example is available <a href="https://github.com/luizpancini/AeroBeams.jl/blob/main/test/examples/initialDispAndVelBeam.jl">here</a>.</p></div></div><h3 id="Initial-conditions"><a class="docs-heading-anchor" href="#Initial-conditions">Initial conditions</a><a id="Initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-conditions" title="Permalink"></a></h3><p>The setup of our problem begins by specifying the initial conditions, defined by the variable <code>initialConditions</code>. These could theoretically be defined by the displacement (<code>u3</code>), the angle of rotation (<code>θ2</code>), or both. However, experience shows that the most accurate results are found with the first option. The displacement and rotation (and their time rates) correspond to those of a simply supported beam&#39;s second bending mode shape. Notice that <code>θ2</code> is the angle of rotation over the beam&#39;s arclength coordinate (<code>x1</code>) and <code>p2</code> is the corresponding Wiener-Milenkovic rotation parameter.</p><pre><code class="language-julia hljs">using AeroBeams

# Select initial conditions as either &quot;displacement&quot;, &quot;rotation&quot; or &quot;both&quot;
initialConditions = &quot;displacement&quot;

# Initial conditions: sinusoidal displacement and velocity of u3 and/or rotation of θ2
δ = 1e-3
σ = 1e-1
u3 = x1 -&gt; δ*sin.(2π*x1/L)
θ2 = x1 -&gt; -δ*2π/L*cos.(2π*x1/L)
p2 = x1 -&gt; 4*tan.(θ2(x1)/4)
udot3 = x1 -&gt; σ*sin.(2π*x1/L)
θdot2 = x1 -&gt; -σ*2π/L*cos.(2π*x1/L)
pdot2 = x1 -&gt; sec.(0/4).^2 .* θdot2(x1)</code></pre><h3 id="Beam"><a class="docs-heading-anchor" href="#Beam">Beam</a><a id="Beam-1"></a><a class="docs-heading-anchor-permalink" href="#Beam" title="Permalink"></a></h3><p>We create a simple isotropic beam for this example. The only relevant properties are the beam&#39;s length (<code>L</code>), bending stiffness (<code>EI</code>) and mass per unit length (<code>ρA</code>). The initial conditions are appended to the beam accordingly, and it is later updated (to incorporate those conditions) with the function <a href="../../publicAPI/#AeroBeams.update_beam!"><code>update_beam!</code></a>.</p><pre><code class="language-julia hljs"># Beam
L = 1
EI = 1
ρA = 1
∞ = 1e4
nElem = 48
beam = create_Beam(name=&quot;beam&quot;,length=L,nElements=nElem,S=[isotropic_stiffness_matrix(∞=∞,EIy=EI)],I=[inertia_matrix(ρA=ρA)])
if initialConditions == &quot;displacement&quot;
    beam.u0_of_x1=x1-&gt;[0; 0; u3(x1)]
    beam.udot0_of_x1=x1-&gt;[0; 0; udot3(x1)]
elseif initialConditions == &quot;rotation&quot;
    beam.p0_of_x1=x1-&gt;[0; p2(x1); 0]
    beam.pdot0_of_x1=x1-&gt;[0; pdot2(x1); 0]
elseif initialConditions == &quot;both&quot;
    beam.u0_of_x1=x1-&gt;[0; 0; u3(x1)]
    beam.p0_of_x1=x1-&gt;[0; p2(x1); 0]
    beam.udot0_of_x1=x1-&gt;[0; 0; udot3(x1)]
    beam.pdot0_of_x1=x1-&gt;[0; pdot2(x1); 0]
else
    error(&quot;Wrong initialConditions&quot;)
end
update_beam!(beam)</code></pre><h3 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h3><p>The beam is simply-supported: pinned at one end and with a roller at the other.</p><pre><code class="language-julia hljs"># BCs
pin = create_BC(name=&quot;pin&quot;,beam=beam,node=1,types=[&quot;u1A&quot;,&quot;u2A&quot;,&quot;u3A&quot;,&quot;p1A&quot;,&quot;p3A&quot;],values=[0,0,0,0,0])
roller = create_BC(name=&quot;roller&quot;,beam=beam,node=nElem+1,types=[&quot;u3A&quot;],values=[0])</code></pre><h3 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h3><p>Our model consists of the beam and the associated boundary conditions. Notice that gravity is neglected.</p><pre><code class="language-julia hljs"># Model
initialDispAndVelBeam = create_Model(name=&quot;initialDispAndVelBeam&quot;,beams=[beam],BCs=[pin,roller])</code></pre><h3 id="Creating-the-dynamic-problem"><a class="docs-heading-anchor" href="#Creating-the-dynamic-problem">Creating the dynamic problem</a><a id="Creating-the-dynamic-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-the-dynamic-problem" title="Permalink"></a></h3><p>The time and frequency variables of our problem are defined by the beam&#39;s second bending mode frequency, <code>ω2</code>, whose analytical value is known. We&#39;ll run the simulation for one cycle, and with a time step one hundredth of that.</p><pre><code class="language-julia hljs"># Time and frequency variables
ω2 = (2π/L)^2*sqrt(EI/ρA)
T = 2π/ω2
cycles = 1
tf = cycles*T
Δt = T/100</code></pre><p>In initial conditions problems, in general we do not know the initial values of all the states of the formulation (displacements, rotations, internal loads and sectional velocities). Thus, we have to estimate the unknown states in the initial step, most importantly the velocities and their rates. The whole simulation is dependent on the accuracy of that estimation, which can be controlled through the dynamic problem&#39;s keyword argument <code>initialVelocitiesUpdateOptions</code>. We create an instance of such a variable using the constructor <a href="../../publicAPI/#AeroBeams.InitialVelocitiesUpdateOptions"><code>InitialVelocitiesUpdateOptions</code></a>. The most important arguments of that are the maximum number of iterations (for which the best value is often 2), <code>maxIter</code>, the relaxation factor (for which the best value is often 0.5), <code>relaxFactor</code>, and the time step (for which the best value is problem-dependent, but has to smaller than the time step of the problem itself), <code>Δt</code>.</p><pre><code class="language-julia hljs"># Initial velocities update options
if initialConditions == &quot;displacement&quot;
    initialVelocitiesUpdateOptions = InitialVelocitiesUpdateOptions(maxIter=2,displayProgress=true, relaxFactor=0.5, Δt=Δt/1e3)
elseif initialConditions == &quot;rotation&quot;
    initialVelocitiesUpdateOptions = InitialVelocitiesUpdateOptions(maxIter=2, tol=1e-8, displayProgress=true, relaxFactor=0.5, Δt=Δt/1e3)
elseif initialConditions == &quot;both&quot;
    initialVelocitiesUpdateOptions = InitialVelocitiesUpdateOptions(maxIter=2, displayProgress=true, relaxFactor=0.5, Δt=Δt/1e3)
end</code></pre><p>Now we can create the problem and solve it.</p><pre><code class="language-julia hljs"># Create and solve the problem
problem = create_DynamicProblem(model=initialDispAndVelBeam,finalTime=tf,Δt=Δt,initialVelocitiesUpdateOptions=initialVelocitiesUpdateOptions)
solve!(problem)</code></pre><h3 id="Post-processing"><a class="docs-heading-anchor" href="#Post-processing">Post-processing</a><a id="Post-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Post-processing" title="Permalink"></a></h3><p>First, we unpack the numerical solution of our variables of interest and compute analytical values.</p><pre><code class="language-julia hljs"># Unpack numerical solution
t = problem.timeVector
tNorm = t/T
u3_quarter = [problem.nodalStatesOverTime[i][div(nElem,4)].u_n2[3] for i in 1:length(tNorm)]
V3_quarter = [(problem.elementalStatesOverTime[i][div(nElem,4)].V[3]+problem.elementalStatesOverTime[i][div(nElem,4)+1].V[3])/2.0 for i in 1:length(tNorm)]
Vdot3_quarter = [(problem.elementalStatesRatesOverTime[i][div(nElem,4)].Vdot[3]+problem.elementalStatesRatesOverTime[i][div(nElem,4)+1].Vdot[3])/2.0 for i in 1:length(tNorm)]
θ2_root = [problem.nodalStatesOverTime[i][1].θ_n1 for i in 1:length(tNorm)]
Ω2_mid = [(problem.elementalStatesOverTime[i][div(nElem,2)].Ω[2]+problem.elementalStatesOverTime[i][div(nElem,2)+1].Ω[2])/2.0 for i in 1:length(tNorm)]
Ωdot2_mid = [(problem.elementalStatesRatesOverTime[i][div(nElem,2)].Ωdot[2]+problem.elementalStatesRatesOverTime[i][div(nElem,2)+1].Ωdot[2])/2.0 for i in 1:length(tNorm)]

# Compute analytical values
u3_quarter_analytic = δ*cos.(ω2*t)*sin(2π*1/4) + σ/ω2*sin.(ω2*t)*sin(2π*1/4)
V3_quarter_analytic = -δ*ω2*sin.(ω2*t)*sin(2π*1/4) + σ*cos.(ω2*t)*sin(2π*1/4)
Vdot3_quarter_analytic = -δ*ω2^2*cos.(ω2*t)*sin(2π*1/4) + -σ*ω2*sin.(ω2*t)*sin(2π*1/4)
θ2_root_analytic = -δ*2π/L*cos.(ω2*t)*cos(2π*0) + -σ*2π/L/ω2*sin.(ω2*t)*cos(2π*0)
Ω2_mid_analytic = δ*2π/L*ω2*sin.(ω2*t)*cos(2π*1/2) + -σ*2π/L*cos.(ω2*t)*cos(2π*1/2)
Ωdot2_mid_analytic = δ*2π/L*ω2^2*cos.(ω2*t)*cos(2π*1/2) + σ*2π/L*ω2*sin.(ω2*t)*cos(2π*1/2)</code></pre><p>Now let&#39;s plot the displacement, rotation, velocities and accelerations at the appropriate points of the beam. The correspondance with the analytical reference is very good, except for the angular acceleration at the midpoint, which oscillates around the analytical solution. That indicates the estimation of the initial value of that variable was not accurate, which may happen for the rates of the velocity states (<span>$\dot{V}$</span> and <span>$\dot{\Omega}$</span>).</p><pre><code class="language-julia hljs">using Plots
gr()

# Displacement at quarter-length
plt1 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$u_3\$ at \$x_1=L/4\$ [m]&quot;)
plot!(tNorm,u3_quarter, c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],u3_quarter_analytic[1:5:end], c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)

# Velocity at quarter-length
plt2 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$V_3\$ at \$x_1=L/4\$ [m/s]&quot;)
plot!(tNorm,V3_quarter, c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],V3_quarter_analytic[1:5:end], c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)

# Acceleration at quarter-length
plt3 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$\\dot{V}_3\$ at \$x_1=L/4\$ [m/\$s^2\$]&quot;)
plot!(tNorm,Vdot3_quarter, c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],Vdot3_quarter_analytic[1:5:end], c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)

# Rotation at root
plt4 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$\\theta/(2\\pi)\$ at \$x_1=0\$&quot;)
plot!(tNorm,θ2_root/(2π), c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],θ2_root_analytic[1:5:end]/(2*π), c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)

# Angular velocity at mid-length
plt5 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$\\Omega_2\$ at \$x_1=L/2\$ [rad/s]&quot;)
plot!(tNorm,Ω2_mid, c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],Ω2_mid_analytic[1:5:end], c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)

# Angular acceleration at mid-length
plt6 = plot(xlabel=&quot;\$t/T\$&quot;, ylabel=&quot;\$\\dot{\\Omega}_2\$ at \$x_1=L/2\$ [rad/\$s^2\$]&quot;)
plot!(tNorm,Ωdot2_mid, c=:black, lw=2, label=&quot;AeroBeams&quot;)
scatter!(tNorm[1:5:end],Ωdot2_mid_analytic[1:5:end], c=:blue, ms=5, msw=0, label=&quot;Analytical&quot;)</code></pre><p><img src="../initialDispAndVelBeam_disp.svg" alt/> <img src="../initialDispAndVelBeam_vel.svg" alt/> <img src="../initialDispAndVelBeam_acc.svg" alt/> <img src="../initialDispAndVelBeam_rot.svg" alt/> <img src="../initialDispAndVelBeam_angVel.svg" alt/> <img src="../initialDispAndVelBeam_angAcc.svg" alt/></p><p>Finally, we can visualize the motion of the beam using the function <a href="../../publicAPI/#AeroBeams.plot_dynamic_deformation"><code>plot_dynamic_deformation</code></a> with the appropriate inputs.</p><pre><code class="language-julia hljs"># Animation
plot_dynamic_deformation(problem,scale=1/δ/10,scalePos=[0.15;-0.05;0],timeStampPos=[0.5;-0.05;0],plotFrequency=1,plotLimits=([0,L],[-L/2,L/2],[-L/3,L/3]),save=true,savePath=&quot;/docs/build/literate/initialDispAndVelBeam_motion.gif&quot;)</code></pre><p><img src="../initialDispAndVelBeam_motion.gif" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../twoStoryFrame/">« Modal analysis of a two-story frame</a><a class="docs-footer-nextpage" href="../flyingScissors/">Dynamic analysis of an articulated beam »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 8 July 2025 15:08">Tuesday 8 July 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
